import{j as w,be as O,bf as R,ag as j,bg as g,b5 as N,q as l,C as _,n as k,a as C}from"./index-bdafdd1b.js";const m=new WeakMap;function b(e,u,n={}){const{mode:y="replace",route:r=w(),router:o=O(),transform:f=i=>i}=n;m.has(o)||m.set(o,new Map);const s=m.get(o);let t=r.query[e];R(()=>{t=void 0});let c;const q=j((i,Q)=>(c=Q,{get(){return i(),f(t!==void 0?t:g(u))},set(a){t!==a&&(t=a===u||a===null?void 0:a,s.set(e,a===u||a===null?void 0:a),Q(),N(()=>{if(s.size===0)return;const v=Object.fromEntries(s.entries());s.clear();const{params:x,query:S,hash:h}=r;o[g(y)]({params:x,query:{...S,...v},hash:h})}))}}));return l(()=>r.query[e],i=>{t=i,c()},{flush:"sync"}),q}const p={number:{fromQuery:e=>Number(e),toQuery:e=>String(e)},string:{fromQuery:e=>e,toQuery:e=>e},boolean:{fromQuery:e=>e.toLowerCase()==="true",toQuery:e=>e?"true":"false"},object:{fromQuery:e=>JSON.parse(e),toQuery:e=>JSON.stringify(e)}};function J({name:e,defaultValue:u}){const y=p[typeof u]??p.string,r=b(e,y.toQuery(u));return C({get(){return y.fromQuery(r.value)},set(o){r.value=y.toQuery(o)}})}function M({name:e,storageName:u,defaultValue:n}){const r=p[typeof n]??p.string,o=_(u,n),f=r.toQuery(n),s=b(e,f),t=k(n);return l(t,c=>{s.value=r.toQuery(c),o.value=c},{deep:!0}),t.value=s.value&&s.value!==f?r.fromQuery(s.value):o.value,t}export{J as a,M as u};
